<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yu-Gi-Oh! Card Database</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #020617;
            color: #f8fafc;
        }

        .card-shadow:hover {
            box-shadow: 0 10px 30px -10px rgba(245, 158, 11, 0.3);
        }

        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #0f172a;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #334155;
            border-radius: 10px;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .animate-fade-in {
            animation: fadeIn 0.3s ease-out forwards;
        }

        .hidden-element {
            display: none !important;
        }
    </style>
</head>
<body class="custom-scrollbar">

    <!-- Header & Filter -->
    <header class="sticky top-0 z-40 bg-slate-900/90 backdrop-blur-md border-b border-slate-800 p-4 shadow-xl">
        <div class="max-w-7xl mx-auto space-y-4">
            <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
                <!-- Logo -->
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-amber-400 to-orange-600 rounded-lg flex items-center justify-center shadow-lg">
                        <span class="font-bold text-black text-xl">YG</span>
                    </div>
                    <h1 class="text-2xl font-black tracking-tighter uppercase italic">
                        Yu-Gi-Oh! <span class="text-amber-500">Database</span>
                    </h1>
                </div>

                <!-- Search Bar -->
                <div class="flex flex-1 max-w-2xl gap-2">
                    <div class="relative flex-1">
                        <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"></i>
                        <input 
                            type="text" 
                            id="searchInput"
                            placeholder="Cari nama kartu..."
                            class="w-full bg-slate-800 border border-slate-700 rounded-full py-2 pl-10 pr-4 focus:outline-none focus:ring-2 focus:ring-amber-500 transition"
                        >
                    </div>
                    <button 
                        id="filterToggle"
                        class="p-2 w-10 h-10 rounded-full border border-slate-700 bg-slate-800 text-slate-400 hover:text-white transition-all flex items-center justify-center"
                    >
                        <i class="fas fa-sliders-h"></i>
                    </button>
                </div>
            </div>

            <!-- Advanced Filter Panel -->
            <div id="filterPanel" class="hidden-element bg-slate-900 border border-slate-800 rounded-2xl p-4 grid grid-cols-1 md:grid-cols-4 gap-4 animate-fade-in">
                <!-- Category -->
                <div class="space-y-2">
                    <label class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Kategori</label>
                    <select id="typeFilter" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-amber-500 outline-none">
                        <option value="All">Semua Kartu</option>
                        <option value="Monster">Monster</option>
                        <option value="Spell">Spell</option>
                        <option value="Trap">Trap</option>
                    </select>
                </div>

                <!-- ATK Range -->
                <div class="space-y-2">
                    <label class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Julat ATK</label>
                    <div class="flex items-center gap-2">
                        <input type="number" id="minAtk" placeholder="Min" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-sm outline-none focus:ring-1 focus:ring-amber-500">
                        <span class="text-slate-600">-</span>
                        <input type="number" id="maxAtk" placeholder="Max" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-sm outline-none focus:ring-1 focus:ring-amber-500">
                    </div>
                </div>

                <!-- DEF Range -->
                <div class="space-y-2">
                    <label class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Julat DEF</label>
                    <div class="flex items-center gap-2">
                        <input type="number" id="minDef" placeholder="Min" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-sm outline-none focus:ring-1 focus:ring-amber-500">
                        <span class="text-slate-600">-</span>
                        <input type="number" id="maxDef" placeholder="Max" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-sm outline-none focus:ring-1 focus:ring-amber-500">
                    </div>
                </div>

                <!-- Level & Attribute -->
                <div class="grid grid-cols-2 gap-2">
                    <div class="space-y-2">
                        <label class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Tahap (LVL)</label>
                        <select id="levelFilter" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-2 py-2 text-sm outline-none">
                            <option value="All">Semua</option>
                            <option value="1">1</option><option value="2">2</option><option value="3">3</option>
                            <option value="4">4</option><option value="5">5</option><option value="6">6</option>
                            <option value="7">7</option><option value="8">8</option><option value="9">9</option>
                            <option value="10">10</option><option value="11">11</option><option value="12">12</option>
                        </select>
                    </div>
                    <div class="space-y-2">
                        <label class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Atribut</label>
                        <select id="attributeFilter" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-2 py-2 text-sm outline-none">
                            <option value="All">Semua</option>
                            <option value="DARK">DARK</option><option value="EARTH">EARTH</option>
                            <option value="FIRE">FIRE</option><option value="LIGHT">LIGHT</option>
                            <option value="WATER">WATER</option><option value="WIND">WIND</option>
                            <option value="DIVINE">DIVINE</option>
                        </select>
                    </div>
                </div>

                <div class="md:col-span-4 flex justify-end">
                    <button id="resetBtn" class="flex items-center gap-2 text-xs font-bold text-amber-500 hover:bg-amber-500/10 px-4 py-2 rounded-lg transition">
                        <i class="fas fa-undo-alt"></i> Reset Filter
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto p-4 md:p-8">
        <!-- Loading State -->
        <div id="loading" class="flex flex-col items-center justify-center py-20">
            <i class="fas fa-circle-notch fa-spin text-4xl text-amber-500 mb-4"></i>
            <p class="text-slate-400 text-lg animate-pulse">Loading...</p>
        </div>

        <!-- Result Info -->
        <div id="resultsInfo" class="hidden-element mb-6 flex items-center justify-between">
            <p class="text-slate-400">
                Ditemukan <span id="countDisplay" class="text-white font-medium">0</span> kartu
            </p>
        </div>

        <!-- Grid -->
        <div id="cardGrid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4 md:gap-6">
            <!-- Cards will be injected here -->
        </div>

        <!-- Empty State -->
        <div id="emptyState" class="hidden-element text-center py-20 bg-slate-900/50 rounded-2xl border border-dashed border-slate-800">
            <i class="fas fa-search-minus text-4xl text-slate-700 mb-4"></i>
            <h3 class="text-xl font-bold text-slate-400">Kartu tidak ditemukan</h3>
            <p class="text-slate-500">Sesuaikan filter atau kata kunci anda.</p>
        </div>

        <!-- Load More -->
        <div id="loadMoreContainer" class="hidden-element mt-12 flex justify-center">
            <button id="loadMoreBtn" class="flex items-center gap-2 bg-slate-800 hover:bg-slate-700 border border-slate-700 px-8 py-3 rounded-full font-bold transition-all hover:scale-105 active:scale-95 shadow-lg">
                Muat Lebih Banyak
                <i class="fas fa-chevron-down"></i>
            </button>
        </div>
    </main>

    <!-- Modal Detail -->
    <div id="cardModal" class="hidden-element fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/90 backdrop-blur-sm">
        <div class="bg-slate-900 w-full max-w-4xl max-h-[90vh] overflow-y-auto rounded-3xl border border-slate-800 shadow-2xl relative custom-scrollbar">
            <button id="closeModal" class="absolute right-4 top-4 z-10 p-2 bg-slate-800 hover:bg-slate-700 rounded-full transition">
                <i class="fas fa-times w-6 h-6 flex items-center justify-center"></i>
            </button>

            <div id="modalContent" class="grid md:grid-cols-2 gap-8 p-6 md:p-10">
                <!-- Content injected via JS -->
            </div>
        </div>
    </div>

    <footer class="mt-20 border-t border-slate-800 p-8 text-center text-slate-500 text-sm">
        <p>© 2024 Yu-Gi-Oh! Database</p>
    </footer>

    <script>
        // Global State
        let allCards = [];
        let filteredCards = [];
        let displayLimit = 24;

        // Elements
        const cardGrid = document.getElementById('cardGrid');
        const loadingEl = document.getElementById('loading');
        const resultsInfo = document.getElementById('resultsInfo');
        const countDisplay = document.getElementById('countDisplay');
        const emptyState = document.getElementById('emptyState');
        const loadMoreContainer = document.getElementById('loadMoreContainer');
        const filterPanel = document.getElementById('filterPanel');
        const cardModal = document.getElementById('cardModal');
        const modalContent = document.getElementById('modalContent');

        // Inputs
        const searchInput = document.getElementById('searchInput');
        const typeFilter = document.getElementById('typeFilter');
        const minAtk = document.getElementById('minAtk');
        const maxAtk = document.getElementById('maxAtk');
        const minDef = document.getElementById('minDef');
        const maxDef = document.getElementById('maxDef');
        const levelFilter = document.getElementById('levelFilter');
        const attributeFilter = document.getElementById('attributeFilter');

        // Initial Fetch
        async function fetchCards() {
            try {
                const response = await fetch('https://db.ygoprodeck.com/api/v7/cardinfo.php');
                const data = await response.json();
                allCards = data.data;
                applyFilters();
                loadingEl.classList.add('hidden-element');
                resultsInfo.classList.remove('hidden-element');
            } catch (error) {
                console.error("Gagal mengambil data:", error);
                loadingEl.innerHTML = `<p class="text-red-500">Ralat sambungan. Sila muat semula halaman.</p>`;
            }
        }

        // Apply Logic
        function applyFilters() {
            const query = searchInput.value.toLowerCase();
            const type = typeFilter.value;
            const lv = levelFilter.value;
            const attr = attributeFilter.value;

            filteredCards = allCards.filter(card => {
                const isMonster = card.type.toLowerCase().includes('monster');
                
                // Name match
                if (!card.name.toLowerCase().includes(query)) return false;

                // Type match
                if (type === 'Monster' && !isMonster) return false;
                if (type === 'Spell' && !card.type.toLowerCase().includes('spell')) return false;
                if (type === 'Trap' && !card.type.toLowerCase().includes('trap')) return false;

                // Monster specific stats
                if (isMonster || type === 'All') {
                    if (isMonster) {
                        if (minAtk.value && card.atk < parseInt(minAtk.value)) return false;
                        if (maxAtk.value && card.atk > parseInt(maxAtk.value)) return false;
                        if (minDef.value && card.def < parseInt(minDef.value)) return false;
                        if (maxDef.value && card.def > parseInt(maxDef.value)) return false;
                        if (lv !== 'All' && card.level !== parseInt(lv)) return false;
                        if (attr !== 'All' && card.attribute !== attr) return false;
                    } else if (type === 'Monster') {
                        return false;
                    }
                }

                return true;
            });

            displayLimit = 24;
            renderGrid();
        }

        // Render Grid
        function renderGrid() {
            cardGrid.innerHTML = '';
            const toShow = filteredCards.slice(0, displayLimit);
            
            countDisplay.innerText = filteredCards.length;

            if (toShow.length === 0) {
                emptyState.classList.remove('hidden-element');
                loadMoreContainer.classList.add('hidden-element');
            } else {
                emptyState.classList.add('hidden-element');
                toShow.forEach(card => {
                    const cardEl = document.createElement('div');
                    cardEl.className = 'group bg-slate-900 rounded-xl overflow-hidden border border-slate-800 hover:border-amber-500/50 transition-all duration-300 hover:-translate-y-2 card-shadow cursor-pointer flex flex-col animate-fade-in';
                    cardEl.onclick = () => showDetail(card);
                    
                    cardEl.innerHTML = `
                        <div class="aspect-[0.686] relative overflow-hidden bg-slate-800">
                            <img src="${card.card_images[0].image_url_small}" alt="${card.name}" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500" loading="lazy">
                            ${card.attribute ? `<div class="absolute top-2 right-2 bg-black/60 backdrop-blur-md text-[8px] font-bold px-1.5 py-0.5 rounded border border-white/20 text-white">${card.attribute}</div>` : ''}
                        </div>
                        <div class="p-3 flex-1 flex flex-col justify-between">
                            <h3 class="font-bold text-sm leading-tight text-slate-200 line-clamp-2 group-hover:text-amber-400 transition-colors">${card.name}</h3>
                            ${(card.atk !== undefined) ? `
                                <div class="mt-2 text-[10px] font-mono text-slate-500 flex justify-between border-t border-slate-800 pt-2">
                                    <span>ATK/${card.atk}</span>
                                    <span>DEF/${card.def}</span>
                                </div>
                            ` : ''}
                        </div>
                    `;
                    cardGrid.appendChild(cardEl);
                });

                if (displayLimit < filteredCards.length) {
                    loadMoreContainer.classList.remove('hidden-element');
                } else {
                    loadMoreContainer.classList.add('hidden-element');
                }
            }
        }

        // Show Detail Modal
        function showDetail(card) {
            modalContent.innerHTML = `
                <div class="flex flex-col items-center">
                    <img src="${card.card_images[0].image_url}" alt="${card.name}" class="w-full max-w-[320px] rounded-lg shadow-2xl border border-slate-800">
                    <div class="mt-6 w-full bg-slate-800/50 rounded-2xl p-4 border border-slate-800">
                        <h4 class="text-[10px] uppercase tracking-widest text-slate-500 mb-3 font-bold text-center">Info Tambahan</h4>
                        <div class="space-y-2 text-xs">
                            <div class="flex justify-between border-b border-slate-700 pb-1">
                                <span class="text-slate-500">Baka/Race:</span>
                                <span class="text-slate-200">${card.race}</span>
                            </div>
                            ${card.archetype ? `
                                <div class="flex justify-between border-b border-slate-700 pb-1">
                                    <span class="text-slate-500">Archetype:</span>
                                    <span class="text-amber-500">${card.archetype}</span>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                </div>
                <div class="flex flex-col">
                    <div class="mb-6">
                        <div class="flex flex-wrap gap-2 mb-4">
                            ${card.attribute ? `<span class="px-3 py-1 bg-amber-500 text-black text-[10px] font-black uppercase rounded-full tracking-widest">${card.attribute}</span>` : ''}
                            <span class="px-3 py-1 bg-slate-800 text-slate-300 text-[10px] font-black uppercase rounded-full tracking-widest">${card.type}</span>
                        </div>
                        <h2 class="text-3xl font-black text-white leading-tight">${card.name}</h2>
                        ${card.level ? `
                            <div class="flex items-center gap-1 mt-3">
                                ${Array(card.level).fill('<div class="w-5 h-5 bg-gradient-to-tr from-orange-600 to-amber-400 rounded-full flex items-center justify-center shadow-lg"><span class="text-[10px] text-black">★</span></div>').join('')}
                                <span class="ml-2 text-slate-400 text-sm font-bold">LVL ${card.level}</span>
                            </div>
                        ` : ''}
                    </div>
                    <div class="bg-slate-800/50 rounded-2xl p-6 border border-slate-800 flex-1">
                        <h4 class="text-[10px] uppercase tracking-widest text-amber-500 mb-3 font-bold flex items-center gap-2">
                            <i class="fas fa-info-circle"></i> Deskripsi Kartu
                        </h4>
                        <p class="text-slate-300 text-sm leading-relaxed whitespace-pre-wrap">${card.desc}</p>
                    </div>
                    ${card.atk !== undefined ? `
                        <div class="mt-6 grid grid-cols-2 gap-4">
                            <div class="bg-red-900/10 border border-red-900/30 p-4 rounded-2xl flex justify-between items-center">
                                <span class="font-black text-red-500">ATK</span>
                                <span class="text-2xl font-black">${card.atk}</span>
                            </div>
                            <div class="bg-blue-900/10 border border-blue-900/30 p-4 rounded-2xl flex justify-between items-center">
                                <span class="font-black text-blue-500">DEF</span>
                                <span class="text-2xl font-black">${card.def}</span>
                            </div>
                        </div>
                    ` : ''}
                    <a href="https://db.ygoprodeck.com/card/?search=${encodeURIComponent(card.name)}" target="_blank" class="mt-6 flex items-center justify-center gap-2 bg-white text-slate-950 py-4 rounded-2xl font-black transition-all hover:bg-amber-400 active:scale-95">
                        Detail Luaran <i class="fas fa-external-link-alt"></i>
                    </a>
                </div>
            `;
            cardModal.classList.remove('hidden-element');
            document.body.style.overflow = 'hidden';
        }

        // Event Listeners
        document.getElementById('filterToggle').onclick = () => {
            filterPanel.classList.toggle('hidden-element');
        };

        document.getElementById('closeModal').onclick = () => {
            cardModal.classList.add('hidden-element');
            document.body.style.overflow = 'auto';
        };

        document.getElementById('loadMoreBtn').onclick = () => {
            displayLimit += 24;
            renderGrid();
        };

        document.getElementById('resetBtn').onclick = () => {
            searchInput.value = '';
            typeFilter.value = 'All';
            minAtk.value = ''; maxAtk.value = '';
            minDef.value = ''; maxDef.value = '';
            levelFilter.value = 'All';
            attributeFilter.value = 'All';
            applyFilters();
        };

        // Live Filtering
        [searchInput, typeFilter, minAtk, maxAtk, minDef, maxDef, levelFilter, attributeFilter].forEach(el => {
            el.oninput = applyFilters;
        });

        // Initialize
        window.onload = fetchCards;
    </script>
</body>
</html>